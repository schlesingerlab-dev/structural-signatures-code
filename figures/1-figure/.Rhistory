geom_text(data = average.aucs[average.aucs$size==50, ], aes(.78, .25, label = paste0("AUC50", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 5) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.76, .15, label = paste0("AUC250", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 5) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.74, .05, label = paste0("AUC1000", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 5) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.78, .25, label = paste0("AUC50", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 10) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.76, .15, label = paste0("AUC250", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 10) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.74, .05, label = paste0("AUC1000", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 10) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.78, .25, label = paste0("AUC50", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 10) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.76, .15, label = paste0("AUC250", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 10) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.74, .05, label = paste0("AUC1000", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.78, .25, label = paste0("AUC50", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.76, .15, label = paste0("AUC250", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.74, .05, label = paste0("AUC1000", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.68, .45, label = paste0("AUC50", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.66, .15, label = paste0("AUC250", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.64, .05, label = paste0("AUC1000", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.68, .45, label = paste0("AUC50", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.65, .25, label = paste0("AUC250", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.64, .05, label = paste0("AUC1000", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.68, .45, label = paste0("AUC50", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.65, .25, label = paste0("AUC250", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.63, .05, label = paste0("AUC1000", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.68, .45, label = paste0("AUC50", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.65, .25, label = paste0("AUC250", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.62, .05, label = paste0("AUC1000", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
p = ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.68, .45, label = paste0("AUC50", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.65, .25, label = paste0("AUC250", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.62, .05, label = paste0("AUC1000", ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-t', g$layout$name))
fills <- cl3
k <- 1
for (i in strip_both) {
if ( g$grobs[[i]]$grobs %>% is.null() )
{
next()
}
else
{
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
print(paste(i,  k,  j , sep =" "))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
}
grid.draw(g)
average.aucs = roc.total %>%  group_by(tissue, size ) %>%  summarise(average_auc=(mean(auc))) %>%  as.data.frame()
average.aucs
setwd("~/schlesslab/lincs/4_2019/01_Jan/Figure1/")
ene50 = read.csv("top.50.genes.csv", header = F , stringsAsFactors = F)
gene250 = read.csv("top.250.genes.csv", header = F , stringsAsFactors = F)
gene1000 = read.csv("../allcombined.txt.2", header = T , stringsAsFactors = F)
colnames(gene50) =c("SID", "Sub-Tissue", "Tissue", "Gene", "Rank")
colnames(gene250) =c("SID", "Sub-Tissue", "Tissue", "Gene", "Rank")
colnames(gene1000) =c("SID", "Sub-Tissue", "Tissue", "Gene", "Rank")
gene50$size = rep(50, nrow(gene50))
gene250$size = rep(250, nrow(gene250))
gene1000$size = rep(1000, nrow(gene1000))
gene50.sp = split(gene50, f= gene50$`Sub-Tissue`)
gene250.sp = split(gene250, f= gene250$`Sub-Tissue` )
gene1000.sp = split(gene1000, f= gene1000$`Sub-Tissue` )
compute_jaccard  = function(df.sp ){
df.final = data.frame()
for ( i in df.sp)
{
i$val = rep(1, nrow(i))
size = i$size %>%  unique
tiss = i$`Sub-Tissue` %>%  unique
overalltissue = i$Tissue %>% unique
print(tiss)
i[,c(2,3,5)] = NULL
i.wide = spread(data = i, key = Gene ,  value = val,  fill = 0 ) %>%  as.data.frame()
row.names(i.wide) = i.wide$SID
i.wide$SID = NULL
i.dist = vegdist(data.matrix(i.wide), method = "jaccard", binary = T ,
upper = T, diag = T ) %>% data.matrix() %>%  as.data.frame()
distances = i.dist[upper.tri(i.dist)] %>%  as.numeric()
distances = 1 - distances
df = data.frame()
df = cbind(rep(tiss, length(distances)), distances) %>%  as.data.frame()
df$size = rep(size , nrow(df))
df$tissue = rep(overalltissue , nrow(df))
df.final = rbind(df.final, df)
}
df.final$V1 = df.final$V1 %>%  as.factor()
df.final$distances = df.final$distances %>%  as.character() %>% as.numeric()
df.final$size = df.final$size %>%  as.factor()
return(df.final)
}
df.50 = compute_jaccard(gene50.sp)
df.250 = compute_jaccard(gene250.sp)
df.1000 = compute_jaccard(gene1000.sp)
##stable 1
df.final = rbind( df.50 , df.250, df.1000)
gene50 = read.csv("top.50.genes.csv", header = F , stringsAsFactors = F)
gene250 = read.csv("top.250.genes.csv", header = F , stringsAsFactors = F)
gene1000 = read.csv("../allcombined.txt.2", header = T , stringsAsFactors = F)
colnames(gene50) =c("SID", "Sub-Tissue", "Tissue", "Gene", "Rank")
colnames(gene250) =c("SID", "Sub-Tissue", "Tissue", "Gene", "Rank")
colnames(gene1000) =c("SID", "Sub-Tissue", "Tissue", "Gene", "Rank")
gene50$size = rep(50, nrow(gene50))
gene250$size = rep(250, nrow(gene250))
gene1000$size = rep(1000, nrow(gene1000))
gene50.sp = split(gene50, f= gene50$`Sub-Tissue`)
gene250.sp = split(gene250, f= gene250$`Sub-Tissue` )
gene1000.sp = split(gene1000, f= gene1000$`Sub-Tissue` )
compute_jaccard  = function(df.sp ){
df.final = data.frame()
for ( i in df.sp)
{
i$val = rep(1, nrow(i))
size = i$size %>%  unique
tiss = i$`Sub-Tissue` %>%  unique
overalltissue = i$Tissue %>% unique
print(tiss)
i[,c(2,3,5)] = NULL
i.wide = spread(data = i, key = Gene ,  value = val,  fill = 0 ) %>%  as.data.frame()
row.names(i.wide) = i.wide$SID
i.wide$SID = NULL
i.dist = vegdist(data.matrix(i.wide), method = "jaccard", binary = T ,
upper = T, diag = T ) %>% data.matrix() %>%  as.data.frame()
distances = i.dist[upper.tri(i.dist)] %>%  as.numeric()
distances = 1 - distances
df = data.frame()
df = cbind(rep(tiss, length(distances)), distances) %>%  as.data.frame()
df$size = rep(size , nrow(df))
df$tissue = rep(overalltissue , nrow(df))
df.final = rbind(df.final, df)
}
df.final$V1 = df.final$V1 %>%  as.factor()
df.final$distances = df.final$distances %>%  as.character() %>% as.numeric()
df.final$size = df.final$size %>%  as.factor()
return(df.final)
}
df.50 = compute_jaccard(gene50.sp)
df.250 = compute_jaccard(gene250.sp)
df.1000 = compute_jaccard(gene1000.sp)
head(gene50)
gene50.sp = split(gene50, f= gene50$`Tissue`)
gene250.sp = split(gene250, f= gene250$`Tissue` )
gene1000.sp = split(gene1000, f= gene1000$`Tissue` )
compute_jaccard  = function(df.sp ){
df.final = data.frame()
for ( i in df.sp)
{
i$val = rep(1, nrow(i))
size = i$size %>%  unique
tiss = i$`Sub-Tissue` %>%  unique
overalltissue = i$Tissue %>% unique
print(tiss)
i[,c(2,3,5)] = NULL
i.wide = spread(data = i, key = Gene ,  value = val,  fill = 0 ) %>%  as.data.frame()
row.names(i.wide) = i.wide$SID
i.wide$SID = NULL
i.dist = vegdist(data.matrix(i.wide), method = "jaccard", binary = T ,
upper = T, diag = T ) %>% data.matrix() %>%  as.data.frame()
distances = i.dist[upper.tri(i.dist)] %>%  as.numeric()
distances = 1 - distances
df = data.frame()
df = cbind(rep(tiss, length(distances)), distances) %>%  as.data.frame()
df$size = rep(size , nrow(df))
df$tissue = rep(overalltissue , nrow(df))
df.final = rbind(df.final, df)
}
df.final$V1 = df.final$V1 %>%  as.factor()
df.final$distances = df.final$distances %>%  as.character() %>% as.numeric()
df.final$size = df.final$size %>%  as.factor()
return(df.final)
}
compute_jaccard  = function(df.sp ){
df.final = data.frame()
for ( i in df.sp)
{
i$val = rep(1, nrow(i))
size = i$size %>%  unique
tiss = i$`Tissue` %>%  unique
overalltissue = i$Tissue %>% unique
print(tiss)
i[,c(2,3,5)] = NULL
i.wide = spread(data = i, key = Gene ,  value = val,  fill = 0 ) %>%  as.data.frame()
row.names(i.wide) = i.wide$SID
i.wide$SID = NULL
i.dist = vegdist(data.matrix(i.wide), method = "jaccard", binary = T ,
upper = T, diag = T ) %>% data.matrix() %>%  as.data.frame()
distances = i.dist[upper.tri(i.dist)] %>%  as.numeric()
distances = 1 - distances
df = data.frame()
df = cbind(rep(tiss, length(distances)), distances) %>%  as.data.frame()
df$size = rep(size , nrow(df))
df$tissue = rep(overalltissue , nrow(df))
df.final = rbind(df.final, df)
}
df.final$V1 = df.final$V1 %>%  as.factor()
df.final$distances = df.final$distances %>%  as.character() %>% as.numeric()
df.final$size = df.final$size %>%  as.factor()
return(df.final)
}
df.50 = compute_jaccard(gene50.sp)
df.50 %>%  head
df.50 %>%  tail
df.250 = compute_jaccard(gene250.sp)
df.1000 = compute_jaccard(gene1000.sp)
df.final = rbind( df.50 , df.250, df.1000)
head(df.1000)
head(df.final)
df.final$tissue
df.final$tissue %>%  unique
names(df.final) = c("tissue2", "distances", "size", "issue")
head
head(df.final)
df.final %>%  group_by(tissue, size ) %>%  summarise(average_jdist=(mean(distances))) %>%  as.data.frame()
names(df.final) = c("tissue2", "distances", "size", "tissue")
df.final %>%  group_by(tissue, size ) %>%  summarise(average_jdist=(mean(distances))) %>%  as.data.frame()
average.jdist =  df.final %>%  group_by(tissue, size ) %>%  summarise(average_jdist=(mean(distances))) %>%  as.data.frame()
merge(average.aucs, average.jdist , by = c(tissue, size))
merge(average.aucs, average.jdist , by = c("tissue", "size"))
df.jdist.auc = merge(average.aucs, average.jdist , by = c("tissue", "size"))
ggplot(df.jdist.auc, aes(average_auc, average_jdist)) +
geom_point() +
facet_wrap(~size)
ggplot(df.jdist.auc, aes(average_auc, average_jdist)) +
geom_point() +
facet_wrap(~size, scales = "free")
ggplot(df.jdist.auc, aes(average_auc, average_jdist)) +
geom_point() #+
average.jdist =  df.final %>%  group_by(tissue, size ) %>%  summarise(average_jdist=(median(distances))) %>%  as.data.frame()
df.jdist.auc = merge(average.aucs, average.jdist , by = c("tissue", "size"))
ggplot(df.jdist.auc, aes(average_auc, average_jdist)) +
geom_point() #+
ggplot(df.jdist.auc, aes( average_jdist, average_auc)) +
geom_point() #+
ggplot(df.jdist.auc, aes( average_jdist, log(average_auc))) +
geom_point() #+
ggplot(df.jdist.auc, aes( log(average_jdist), log(average_auc))) +
geom_point() #+
ggplot(df.jdist.auc, aes( log(average_jdist), log(average_auc))) +
geom_point() +
facet_wrap(~size, scales = "free")
ggplot(df.jdist.auc, aes( average_jdist, average_auc)) +
geom_point() +
facet_wrap(~size, scales = "free")
p = ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.68, .45, label = paste0(bquote('AUC[50]'), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.65, .25, label = paste0(bquote('AUC250'), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.62, .05, label = paste0(bquote('AUC1000'), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-t', g$layout$name))
fills <- cl3
k <- 1
for (i in strip_both) {
if ( g$grobs[[i]]$grobs %>% is.null() )
{
next()
}
else
{
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
print(paste(i,  k,  j , sep =" "))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
}
grid.draw(g)
p = ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.68, .45, label = paste0(bquote(AUC[50]), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.65, .25, label = paste0(bquote(AUC[250]), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.62, .05, label = paste0(bquote(AUC[1000]), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-t', g$layout$name))
fills <- cl3
k <- 1
for (i in strip_both) {
if ( g$grobs[[i]]$grobs %>% is.null() )
{
next()
}
else
{
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
print(paste(i,  k,  j , sep =" "))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
}
grid.draw(g)
p = ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.68, .45, label = paste0(bquote(~AUC[50]~), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.65, .25, label = paste0(bquote(AUC[250]), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.62, .05, label = paste0(bquote(AUC[1000]), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
p = ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.68, .45, label = paste0(bquote(~AUC[50]), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.65, .25, label = paste0(bquote(AUC[250]), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.62, .05, label = paste0(bquote(AUC[1000]), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-t', g$layout$name))
fills <- cl3
k <- 1
for (i in strip_both) {
if ( g$grobs[[i]]$grobs %>% is.null() )
{
next()
}
else
{
j <- which(grepl('rect', g$grobs[[i]]$grobs[[1]]$childrenOrder))
print(paste(i,  k,  j , sep =" "))
g$grobs[[i]]$grobs[[1]]$children[[j]]$gp$fill <- fills[k]
k <- k+1
}
}
grid.draw(g)
p = ggplot(roc.total, aes( 1- Specificity ,Sensitivity , color = factor(size) )) +
geom_line(size = 1.5, alpha = .75)  +
geom_text(data = average.aucs[average.aucs$size==50, ], aes(.68, .45, label = bquote( ~'AUC'[50]~ ': ',
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==250, ], aes(.65, .25, label = paste0(bquote(AUC[250]), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
geom_text(data = average.aucs[average.aucs$size==1000, ], aes(.62, .05, label = paste0(bquote(AUC[1000]), ": ",
round(average_auc, 3) ),
group = tissue), color = "black", size = 7) +
facet_wrap(~tissue, nrow = 4) +
geom_abline( slope = 1, intercept = 0 , color ="red") +
theme_bw() +
scale_color_manual(values = cl) +
theme(axis.title = element_text(size  = 20),
strip.text.x = element_text(size = 20))
g <- ggplot_gtable(ggplot_build(p))
strip_both <- which(grepl('strip-t', g$layout$name))
fills <- cl3
k <- 1
ggplot(df.jdist.auc, aes( average_jdist, average_auc)) +
geom_point() +
facet_wrap(~size, scales = "free")
cor(df.jdist.auc$average_auc, df.jdist.auc$average_auc)
cor(df.jdist.auc$average_auc, df.jdist.auc$average_jdist)
